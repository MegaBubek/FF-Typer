<!DOCTYPE html><html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FF-Typer</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f2f2f2; margin: 0; padding: 0; }
    .container { max-width: 800px; margin: auto; padding: 20px; background: white; border-radius: 8px; }
    h1 { text-align: center; }
    .match { margin: 10px 0; padding: 10px; border: 1px solid #ccc; border-radius: 6px; background: #fafafa; }
    .prediction-input { width: 50px; margin: 0 5px; }
    button { padding: 6px 12px; margin-top: 10px; cursor: pointer; }
    .submitted-types { margin-top: 20px; }
  </style>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, serverTimestamp, query, orderBy } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore.js";const firebaseConfig = {
  apiKey: "AIzaSyDIhMW94ZY7_7w8yttJSHAwmCPR3bSTsHw",
  authDomain: "ff-typer.firebaseapp.com",
  projectId: "ff-typer",
  storageBucket: "ff-typer.appspot.com",
  messagingSenderId: "22978913956",
  appId: "1:22978913956:web:6e6113180e48142d952831",
  measurementId: "G-2BFZY3PWFZ"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const matches = [
  { id: "1", home: "Legia", away: "Lech" },
  { id: "2", home: "Wisła", away: "Pogoń" },
  { id: "3", home: "Cracovia", away: "Widzew" }
];

const container = document.querySelector(".container");
const typesDiv = document.getElementById("submittedTypes");
let username = localStorage.getItem("fftyper_username") || prompt("Podaj swój nick:");
localStorage.setItem("fftyper_username", username);

function createMatchElements() {
  matches.forEach(match => {
    const div = document.createElement("div");
    div.className = "match";
    div.innerHTML = `
      <strong>${match.home} vs ${match.away}</strong><br>
      <input id="home-${match.id}" class="prediction-input" type="number" min="0"> : 
      <input id="away-${match.id}" class="prediction-input" type="number" min="0">
      <button onclick="submitPrediction('${match.id}', '${match.home}', '${match.away}')">Zapisz</button>
    `;
    container.appendChild(div);
  });
}

window.submitPrediction = async (matchId, home, away) => {
  const homeGoals = document.getElementById(`home-${matchId}`).value;
  const awayGoals = document.getElementById(`away-${matchId}`).value;
  if (homeGoals === "" || awayGoals === "") return alert("Podaj oba wyniki!");

  await addDoc(collection(db, "types"), {
    user: username,
    matchId,
    homeTeam: home,
    awayTeam: away,
    prediction: `${homeGoals}:${awayGoals}`,
    timestamp: serverTimestamp()
  });
  alert("Typ zapisany!");
  loadPredictions();
};

async function loadPredictions() {
  typesDiv.innerHTML = "<h2>Typy graczy</h2>";
  const q = query(collection(db, "types"), orderBy("timestamp", "desc"));
  const snapshot = await getDocs(q);

  snapshot.forEach(doc => {
    const data = doc.data();
    const time = data.timestamp?.toDate().toLocaleString("pl-PL") || "brak czasu";
    const p = document.createElement("p");
    p.textContent = `${data.user} obstawił ${data.homeTeam} - ${data.awayTeam} ${data.prediction} (${time})`;
    typesDiv.appendChild(p);
  });
}

createMatchElements();
loadPredictions();

  </script>
</head>
<body>
  <div class="container">
    <h1>FF-Typer - Kolejka 1</h1>
    <!-- Mecze będą generowane tutaj -->
    <div id="submittedTypes" class="submitted-types"></div>
  </div>
</body>
</html>
